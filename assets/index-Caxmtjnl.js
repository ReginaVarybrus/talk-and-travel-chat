import{n as I,q as ae,j as ie,b as F}from"./index-CrNaRwaL.js";import{G as z}from"./iconBase-WapkZLuH.js";function K(v){throw new Error('Could not dynamically require "'+v+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var re={exports:{}};(function(v,c){(function(e){v.exports=e()})(function(){return function e(n,p,t){function r(s,o){if(!p[s]){if(!n[s]){var l=typeof K=="function"&&K;if(!o&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var m=p[s]={exports:{}};n[s][0].call(m.exports,function(f){return r(n[s][1][f]||f)},m,m.exports,e,n,p,t)}return p[s].exports}for(var i=typeof K=="function"&&K,a=0;a<t.length;a++)r(t[a]);return r}({1:[function(e,n,p){(function(t){(function(){var r=e("./transport-list");n.exports=e("./main")(r),"_sockjs_onload"in t&&setTimeout(t._sockjs_onload,1)}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./main":14,"./transport-list":16}],2:[function(e,n,p){var t=e("inherits"),r=e("./event");function i(){r.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}t(i,r),n.exports=i},{"./event":4,inherits:54}],3:[function(e,n,p){var t=e("inherits"),r=e("./eventtarget");function i(){r.call(this)}t(i,r),i.prototype.removeAllListeners=function(a){a?delete this._listeners[a]:this._listeners={}},i.prototype.once=function(a,s){var o=this,l=!1;this.on(a,function u(){o.removeListener(a,u),l||(l=!0,s.apply(this,arguments))})},i.prototype.emit=function(){var a=arguments[0],s=this._listeners[a];if(s){for(var o=arguments.length,l=new Array(o-1),u=1;u<o;u++)l[u-1]=arguments[u];for(var m=0;m<s.length;m++)s[m].apply(this,l)}},i.prototype.on=i.prototype.addListener=r.prototype.addEventListener,i.prototype.removeListener=r.prototype.removeEventListener,n.exports.EventEmitter=i},{"./eventtarget":5,inherits:54}],4:[function(e,n,p){function t(r){this.type=r}t.prototype.initEvent=function(r,i,a){return this.type=r,this.bubbles=i,this.cancelable=a,this.timeStamp=+new Date,this},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,n.exports=t},{}],5:[function(e,n,p){function t(){this._listeners={}}t.prototype.addEventListener=function(r,i){r in this._listeners||(this._listeners[r]=[]);var a=this._listeners[r];a.indexOf(i)===-1&&(a=a.concat([i])),this._listeners[r]=a},t.prototype.removeEventListener=function(r,i){var a=this._listeners[r];if(a){var s=a.indexOf(i);s===-1||(1<a.length?this._listeners[r]=a.slice(0,s).concat(a.slice(s+1)):delete this._listeners[r])}},t.prototype.dispatchEvent=function(){var r=arguments[0],i=r.type,a=arguments.length===1?[r]:Array.apply(null,arguments);if(this["on"+i]&&this["on"+i].apply(this,a),i in this._listeners)for(var s=this._listeners[i],o=0;o<s.length;o++)s[o].apply(this,a)},n.exports=t},{}],6:[function(e,n,p){var t=e("inherits"),r=e("./event");function i(a){r.call(this),this.initEvent("message",!1,!1),this.data=a}t(i,r),n.exports=i},{"./event":4,inherits:54}],7:[function(e,n,p){var t=e("./utils/iframe");function r(i){(this._transport=i).on("message",this._transportMessage.bind(this)),i.on("close",this._transportClose.bind(this))}r.prototype._transportClose=function(i,a){t.postMessage("c",JSON.stringify([i,a]))},r.prototype._transportMessage=function(i){t.postMessage("t",i)},r.prototype._send=function(i){this._transport.send(i)},r.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},n.exports=r},{"./utils/iframe":47}],8:[function(e,n,p){var t=e("./utils/url"),r=e("./utils/event"),i=e("./facade"),a=e("./info-iframe-receiver"),s=e("./utils/iframe"),o=e("./location"),l=function(){};n.exports=function(u,m){var f,b={};m.forEach(function(h){h.facadeTransport&&(b[h.facadeTransport.transportName]=h.facadeTransport)}),b[a.transportName]=a,u.bootstrap_iframe=function(){var h;s.currentWindowId=o.hash.slice(1),r.attachEvent("message",function(g){if(g.source===parent&&(f===void 0&&(f=g.origin),g.origin===f)){var S;try{S=JSON.parse(g.data)}catch{return void l("bad json",g.data)}if(S.windowId===s.currentWindowId)switch(S.type){case"s":var O;try{O=JSON.parse(S.data)}catch{l("bad json",S.data);break}var j=O[0],x=O[1],_=O[2],k=O[3];if(j!==u.version)throw new Error('Incompatible SockJS! Main site uses: "'+j+'", the iframe: "'+u.version+'".');if(!t.isOriginEqual(_,o.href)||!t.isOriginEqual(k,o.href))throw new Error("Can't connect to different domain from within an iframe. ("+o.href+", "+_+", "+k+")");h=new i(new b[x](_,k));break;case"m":h._send(S.data);break;case"c":h&&h._close(),h=null}}}),s.postMessage("s")}}},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:void 0}],9:[function(e,n,p){var t=e("events").EventEmitter,r=e("inherits"),i=e("./utils/object");function a(s,o){t.call(this);var l=this,u=+new Date;this.xo=new o("GET",s),this.xo.once("finish",function(m,f){var b,h;if(m===200){if(h=+new Date-u,f)try{b=JSON.parse(f)}catch{}i.isObject(b)||(b={})}l.emit("finish",b,h),l.removeAllListeners()})}r(a,t),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},n.exports=a},{"./utils/object":49,debug:void 0,events:3,inherits:54}],10:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter,i=e("./transport/sender/xhr-local"),a=e("./info-ajax");function s(o){var l=this;r.call(this),this.ir=new a(o,i),this.ir.once("finish",function(u,m){l.ir=null,l.emit("message",JSON.stringify([u,m]))})}t(s,r),s.transportName="iframe-info-receiver",s.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},n.exports=s},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:54}],11:[function(e,n,p){(function(t){(function(){var r=e("events").EventEmitter,i=e("inherits"),a=e("./utils/event"),s=e("./transport/iframe"),o=e("./info-iframe-receiver");function l(u,m){var f=this;r.call(this);function b(){var h=f.ifr=new s(o.transportName,m,u);h.once("message",function(g){if(g){var S;try{S=JSON.parse(g)}catch{return f.emit("finish"),void f.close()}var O=S[0],j=S[1];f.emit("finish",O,j)}f.close()}),h.once("close",function(){f.emit("finish"),f.close()})}t.document.body?b():a.attachEvent("load",b)}i(l,r),l.enabled=function(){return s.enabled()},l.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},n.exports=l}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:void 0,events:3,inherits:54}],12:[function(e,n,p){var t=e("events").EventEmitter,r=e("inherits"),i=e("./utils/url"),a=e("./transport/sender/xdr"),s=e("./transport/sender/xhr-cors"),o=e("./transport/sender/xhr-local"),l=e("./transport/sender/xhr-fake"),u=e("./info-iframe"),m=e("./info-ajax");function f(b,h){var g=this;t.call(this),setTimeout(function(){g.doXhr(b,h)},0)}r(f,t),f._getReceiver=function(b,h,g){return g.sameOrigin?new m(h,o):s.enabled?new m(h,s):a.enabled&&g.sameScheme?new m(h,a):u.enabled()?new u(b,h):new m(h,l)},f.prototype.doXhr=function(b,h){var g=this,S=i.addPath(b,"/info");this.xo=f._getReceiver(b,S,h),this.timeoutRef=setTimeout(function(){g._cleanup(!1),g.emit("finish")},f.timeout),this.xo.once("finish",function(O,j){g._cleanup(!0),g.emit("finish",O,j)})},f.prototype._cleanup=function(b){clearTimeout(this.timeoutRef),this.timeoutRef=null,!b&&this.xo&&this.xo.close(),this.xo=null},f.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},f.timeout=8e3,n.exports=f},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:void 0,events:3,inherits:54}],13:[function(e,n,p){(function(t){(function(){n.exports=t.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],14:[function(e,n,p){(function(t){(function(){e("./shims");var r,i=e("url-parse"),a=e("inherits"),s=e("./utils/random"),o=e("./utils/escape"),l=e("./utils/url"),u=e("./utils/event"),m=e("./utils/transport"),f=e("./utils/object"),b=e("./utils/browser"),h=e("./utils/log"),g=e("./event/event"),S=e("./event/eventtarget"),O=e("./location"),j=e("./event/close"),x=e("./event/trans-message"),_=e("./info-receiver"),k=function(){};function d(E,N,y){if(!(this instanceof d))return new d(E,N,y);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");S.call(this),this.readyState=d.CONNECTING,this.extensions="",this.protocol="",(y=y||{}).protocols_whitelist&&h.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=y.transports,this._transportOptions=y.transportOptions||{},this._timeout=y.timeout||0;var C=y.sessionId||8;if(typeof C=="function")this._generateSessionId=C;else{if(typeof C!="number")throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return s.string(C)}}this._server=y.server||s.numberString(1e3);var T=new i(E);if(!T.host||!T.protocol)throw new SyntaxError("The URL '"+E+"' is invalid");if(T.hash)throw new SyntaxError("The URL must not contain a fragment");if(T.protocol!=="http:"&&T.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+T.protocol+"' is not allowed.");var L=T.protocol==="https:";if(O.protocol==="https:"&&!L&&!l.isLoopbackAddr(T.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");N?Array.isArray(N)||(N=[N]):N=[];var w=N.sort();w.forEach(function(R,W){if(!R)throw new SyntaxError("The protocols entry '"+R+"' is invalid.");if(W<w.length-1&&R===w[W+1])throw new SyntaxError("The protocols entry '"+R+"' is duplicated.")});var H=l.getOrigin(O.href);this._origin=H?H.toLowerCase():null,T.set("pathname",T.pathname.replace(/\/+$/,"")),this.url=T.href,k("using url",this.url),this._urlInfo={nullOrigin:!b.hasDomain(),sameOrigin:l.isOriginEqual(this.url,O.href),sameScheme:l.isSchemeEqual(this.url,O.href)},this._ir=new _(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function A(E){return E===1e3||3e3<=E&&E<=4999}a(d,S),d.prototype.close=function(E,N){if(E&&!A(E))throw new Error("InvalidAccessError: Invalid code");if(N&&123<N.length)throw new SyntaxError("reason argument has an invalid length");this.readyState!==d.CLOSING&&this.readyState!==d.CLOSED&&this._close(E||1e3,N||"Normal closure",!0)},d.prototype.send=function(E){if(typeof E!="string"&&(E=""+E),this.readyState===d.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===d.OPEN&&this._transport.send(o.quote(E))},d.version=e("./version"),d.CONNECTING=0,d.OPEN=1,d.CLOSING=2,d.CLOSED=3,d.prototype._receiveInfo=function(E,N){if(this._ir=null,E){this._rto=this.countRTO(N),this._transUrl=E.base_url?E.base_url:this.url,E=f.extend(E,this._urlInfo);var y=r.filterToEnabled(this._transportsWhitelist,E);this._transports=y.main,k(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},d.prototype._connect=function(){for(var E=this._transports.shift();E;E=this._transports.shift()){if(k("attempt",E.transportName),E.needBody&&(!t.document.body||t.document.readyState!==void 0&&t.document.readyState!=="complete"&&t.document.readyState!=="interactive"))return this._transports.unshift(E),void u.attachEvent("load",this._connect.bind(this));var N=Math.max(this._timeout,this._rto*E.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),N);var y=l.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),C=this._transportOptions[E.transportName],T=new E(y,this._transUrl,C);return T.on("message",this._transportMessage.bind(this)),T.once("close",this._transportClose.bind(this)),T.transportName=E.transportName,void(this._transport=T)}this._close(2e3,"All transports failed",!1)},d.prototype._transportTimeout=function(){this.readyState===d.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},d.prototype._transportMessage=function(E){var N,y=this,C=E.slice(0,1),T=E.slice(1);switch(C){case"o":return void this._open();case"h":return this.dispatchEvent(new g("heartbeat")),void k("heartbeat",this.transport)}if(T)try{N=JSON.parse(T)}catch{}if(N!==void 0)switch(C){case"a":Array.isArray(N)&&N.forEach(function(L){k("message",y.transport),y.dispatchEvent(new x(L))});break;case"m":k("message",this.transport),this.dispatchEvent(new x(N));break;case"c":Array.isArray(N)&&N.length===2&&this._close(N[0],N[1],!0)}},d.prototype._transportClose=function(E,N){k("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),A(E)||E===2e3||this.readyState!==d.CONNECTING?this._close(E,N):this._connect()},d.prototype._open=function(){k("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===d.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=d.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new g("open")),k("connected",this.transport)):this._close(1006,"Server lost session")},d.prototype._close=function(E,N,y){k("_close",this.transport,E,N,y,this.readyState);var C=!1;if(this._ir&&(C=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===d.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=d.CLOSING,setTimeout((function(){this.readyState=d.CLOSED,C&&this.dispatchEvent(new g("error"));var T=new j("close");T.wasClean=y||!1,T.code=E||1e3,T.reason=N,this.dispatchEvent(T),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},d.prototype.countRTO=function(E){return 100<E?4*E:300+E},n.exports=function(E){return r=m(E),e("./iframe-bootstrap")(d,E),d}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:void 0,inherits:54,"url-parse":57}],15:[function(e,n,p){function t(y){return s.toString.call(y)==="[object Function]"}function r(y){return m.call(y)==="[object String]"}var i,a=Array.prototype,s=Object.prototype,o=Function.prototype,l=String.prototype,u=a.slice,m=s.toString,f=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}();i=f?function(y,C,T,L){!L&&C in y||Object.defineProperty(y,C,{configurable:!0,enumerable:!1,writable:!0,value:T})}:function(y,C,T,L){!L&&C in y||(y[C]=T)};function b(y,C,T){for(var L in C)s.hasOwnProperty.call(C,L)&&i(y,L,C[L],T)}function h(y){if(y==null)throw new TypeError("can't convert "+y+" to object");return Object(y)}function g(){}b(o,{bind:function(y){var C=this;if(!t(C))throw new TypeError("Function.prototype.bind called on incompatible "+C);for(var T=u.call(arguments,1),L=Math.max(0,C.length-T.length),w=[],H=0;H<L;H++)w.push("$"+H);var R=Function("binder","return function ("+w.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof R){var W=C.apply(this,T.concat(u.call(arguments)));return Object(W)===W?W:this}return C.apply(y,T.concat(u.call(arguments)))});return C.prototype&&(g.prototype=C.prototype,R.prototype=new g,g.prototype=null),R}}),b(Array,{isArray:function(y){return m.call(y)==="[object Array]"}});var S,O,j,x=Object("a"),_=x[0]!=="a"||!(0 in x);b(a,{forEach:function(y,C){var T=h(this),L=_&&r(this)?this.split(""):T,w=C,H=-1,R=L.length>>>0;if(!t(y))throw new TypeError;for(;++H<R;)H in L&&y.call(w,L[H],H,T)}},(S=a.forEach,j=O=!0,S&&(S.call("foo",function(y,C,T){typeof T!="object"&&(O=!1)}),S.call([1],function(){j=typeof this=="string"},"x")),!(S&&O&&j)));var k=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;b(a,{indexOf:function(y,C){var T=_&&r(this)?this.split(""):h(this),L=T.length>>>0;if(!L)return-1;var w=0;for(1<arguments.length&&(w=function(H){var R=+H;return R!=R?R=0:R!==0&&R!==1/0&&R!==-1/0&&(R=(0<R||-1)*Math.floor(Math.abs(R))),R}(C)),w=0<=w?w:Math.max(0,L+w);w<L;w++)if(w in T&&T[w]===y)return w;return-1}},k);var d,A=l.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||1<".".split(/()()/).length?(d=/()??/.exec("")[1]===void 0,l.split=function(y,C){var T=this;if(y===void 0&&C===0)return[];if(m.call(y)!=="[object RegExp]")return A.call(this,y,C);var L,w,H,R,W=[],M=(y.ignoreCase?"i":"")+(y.multiline?"m":"")+(y.extended?"x":"")+(y.sticky?"y":""),B=0;for(y=new RegExp(y.source,M+"g"),T+="",d||(L=new RegExp("^"+y.source+"$(?!\\s)",M)),C=C===void 0?-1>>>0:function(D){return D>>>0}(C);(w=y.exec(T))&&!(B<(H=w.index+w[0].length)&&(W.push(T.slice(B,w.index)),!d&&1<w.length&&w[0].replace(L,function(){for(var D=1;D<arguments.length-2;D++)arguments[D]===void 0&&(w[D]=void 0)}),1<w.length&&w.index<T.length&&a.push.apply(W,w.slice(1)),R=w[0].length,B=H,W.length>=C));)y.lastIndex===w.index&&y.lastIndex++;return B===T.length?!R&&y.test("")||W.push(""):W.push(T.slice(B)),W.length>C?W.slice(0,C):W}):"0".split(void 0,0).length&&(l.split=function(y,C){return y===void 0&&C===0?[]:A.call(this,y,C)});var E=l.substr,N="".substr&&"0b".substr(-1)!=="b";b(l,{substr:function(y,C){return E.call(this,y<0&&(y=this.length+y)<0?0:y,C)}},N)},{}],16:[function(e,n,p){n.exports=[e("./transport/websocket"),e("./transport/xhr-streaming"),e("./transport/xdr-streaming"),e("./transport/eventsource"),e("./transport/lib/iframe-wrap")(e("./transport/eventsource")),e("./transport/htmlfile"),e("./transport/lib/iframe-wrap")(e("./transport/htmlfile")),e("./transport/xhr-polling"),e("./transport/xdr-polling"),e("./transport/lib/iframe-wrap")(e("./transport/xhr-polling")),e("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(e,n,p){(function(t){(function(){var r=e("events").EventEmitter,i=e("inherits"),a=e("../../utils/event"),s=e("../../utils/url"),o=t.XMLHttpRequest,l=function(){};function u(b,h,g,S){var O=this;r.call(this),setTimeout(function(){O._start(b,h,g,S)},0)}i(u,r),u.prototype._start=function(b,h,g,S){var O=this;try{this.xhr=new o}catch{}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();h=s.addQuery(h,"t="+ +new Date),this.unloadRef=a.unloadAdd(function(){O._cleanup(!0)});try{this.xhr.open(b,h,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){l("xhr timeout"),O.emit("finish",0,""),O._cleanup(!1)})}catch{return this.emit("finish",0,""),void this._cleanup(!1)}if(S&&S.noCredentials||!u.supportsCORS||(this.xhr.withCredentials=!0),S&&S.headers)for(var j in S.headers)this.xhr.setRequestHeader(j,S.headers[j]);this.xhr.onreadystatechange=function(){if(O.xhr){var x,_,k=O.xhr;switch(l("readyState",k.readyState),k.readyState){case 3:try{_=k.status,x=k.responseText}catch{}_===1223&&(_=204),_===200&&x&&0<x.length&&O.emit("chunk",_,x);break;case 4:_=k.status,_===1223&&(_=204),_!==12005&&_!==12029||(_=0),l("finish",_,k.responseText),O.emit("finish",_,k.responseText),O._cleanup(!1)}}};try{O.xhr.send(g)}catch{O.emit("finish",0,""),O._cleanup(!1)}},u.prototype._cleanup=function(b){if(this.xhr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),b)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!!o;var m=["Active"].concat("Object").join("X");!u.enabled&&m in t&&(u.enabled=!!new(o=function(){try{return new t[m]("Microsoft.XMLHTTP")}catch{return null}}));var f=!1;try{f="withCredentials"in new o}catch{}u.supportsCORS=f,n.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],18:[function(e,n,p){(function(t){(function(){n.exports=t.EventSource}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],19:[function(e,n,p){(function(t){(function(){var r=t.WebSocket||t.MozWebSocket;n.exports=r?function(i){return new r(i)}:void 0}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],20:[function(e,n,p){var t=e("inherits"),r=e("./lib/ajax-based"),i=e("./receiver/eventsource"),a=e("./sender/xhr-cors"),s=e("eventsource");function o(l){if(!o.enabled())throw new Error("Transport created when disabled");r.call(this,l,"/eventsource",i,a)}t(o,r),o.enabled=function(){return!!s},o.transportName="eventsource",o.roundTrips=2,n.exports=o},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:54}],21:[function(e,n,p){var t=e("inherits"),r=e("./receiver/htmlfile"),i=e("./sender/xhr-local"),a=e("./lib/ajax-based");function s(o){if(!r.enabled)throw new Error("Transport created when disabled");a.call(this,o,"/htmlfile",r,i)}t(s,a),s.enabled=function(o){return r.enabled&&o.sameOrigin},s.transportName="htmlfile",s.roundTrips=2,n.exports=s},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:54}],22:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter,i=e("../version"),a=e("../utils/url"),s=e("../utils/iframe"),o=e("../utils/event"),l=e("../utils/random"),u=function(){};function m(f,b,h){if(!m.enabled())throw new Error("Transport created when disabled");r.call(this);var g=this;this.origin=a.getOrigin(h),this.baseUrl=h,this.transUrl=b,this.transport=f,this.windowId=l.string(8);var S=a.addPath(h,"/iframe.html")+"#"+this.windowId;this.iframeObj=s.createIframe(S,function(O){g.emit("close",1006,"Unable to load an iframe ("+O+")"),g.close()}),this.onmessageCallback=this._message.bind(this),o.attachEvent("message",this.onmessageCallback)}t(m,r),m.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){o.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},m.prototype._message=function(f){if(u("message",f.data),a.isOriginEqual(f.origin,this.origin)){var b;try{b=JSON.parse(f.data)}catch{return void u("bad json",f.data)}if(b.windowId===this.windowId)switch(b.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([i,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",b.data);break;case"c":var h;try{h=JSON.parse(b.data)}catch{return void u("bad json",b.data)}this.emit("close",h[0],h[1]),this.close()}else u("mismatched window id",b.windowId,this.windowId)}else u("not same origin",f.origin,this.origin)},m.prototype.postMessage=function(f,b){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:f,data:b||""}),this.origin)},m.prototype.send=function(f){this.postMessage("m",f)},m.enabled=function(){return s.iframeEnabled},m.transportName="iframe",m.roundTrips=2,n.exports=m},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:void 0,events:3,inherits:54}],23:[function(e,n,p){(function(t){(function(){var r=e("inherits"),i=e("./lib/sender-receiver"),a=e("./receiver/jsonp"),s=e("./sender/jsonp");function o(l){if(!o.enabled())throw new Error("Transport created when disabled");i.call(this,l,"/jsonp",s,a)}r(o,i),o.enabled=function(){return!!t.document},o.transportName="jsonp-polling",o.roundTrips=1,o.needBody=!0,n.exports=o}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:54}],24:[function(e,n,p){var t=e("inherits"),r=e("../../utils/url"),i=e("./sender-receiver");function a(s,o,l,u){i.call(this,s,o,function(m){return function(f,b,h){var g={};typeof b=="string"&&(g.headers={"Content-type":"text/plain"});var S=r.addPath(f,"/xhr_send"),O=new m("POST",S,b,g);return O.once("finish",function(j){if(O=null,j!==200&&j!==204)return h(new Error("http status "+j));h()}),function(){O.close(),O=null;var j=new Error("Aborted");j.code=1e3,h(j)}}}(u),l,u)}t(a,i),n.exports=a},{"../../utils/url":52,"./sender-receiver":28,debug:void 0,inherits:54}],25:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter,i=function(){};function a(s,o){r.call(this),this.sendBuffer=[],this.sender=o,this.url=s}t(a,r),a.prototype.send=function(s){this.sendBuffer.push(s),this.sendStop||this.sendSchedule()},a.prototype.sendScheduleWait=function(){var s,o=this;this.sendStop=function(){o.sendStop=null,clearTimeout(s)},s=setTimeout(function(){o.sendStop=null,o.sendSchedule()},25)},a.prototype.sendSchedule=function(){i("sendSchedule",this.sendBuffer.length);var s=this;if(0<this.sendBuffer.length){var o="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,o,function(l){s.sendStop=null,l?(s.emit("close",l.code||1006,"Sending error: "+l),s.close()):s.sendScheduleWait()}),this.sendBuffer=[]}},a.prototype._cleanup=function(){this.removeAllListeners()},a.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},n.exports=a},{debug:void 0,events:3,inherits:54}],26:[function(e,n,p){(function(t){(function(){var r=e("inherits"),i=e("../iframe"),a=e("../../utils/object");n.exports=function(s){function o(l,u){i.call(this,s.transportName,l,u)}return r(o,i),o.enabled=function(l,u){if(!t.document)return!1;var m=a.extend({},u);return m.sameOrigin=!0,s.enabled(m)&&i.enabled()},o.transportName="iframe-"+s.transportName,o.needBody=!0,o.roundTrips=i.roundTrips+s.roundTrips-1,o.facadeTransport=s,o}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/object":49,"../iframe":22,inherits:54}],27:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter,i=function(){};function a(s,o,l){r.call(this),this.Receiver=s,this.receiveUrl=o,this.AjaxObject=l,this._scheduleReceiver()}t(a,r),a.prototype._scheduleReceiver=function(){var s=this,o=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);o.on("message",function(l){s.emit("message",l)}),o.once("close",function(l,u){i("close",l,u,s.pollIsClosing),s.poll=o=null,s.pollIsClosing||(u==="network"?s._scheduleReceiver():(s.emit("close",l||1006,u),s.removeAllListeners()))})},a.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},n.exports=a},{debug:void 0,events:3,inherits:54}],28:[function(e,n,p){var t=e("inherits"),r=e("../../utils/url"),i=e("./buffered-sender"),a=e("./polling");function s(o,l,u,m,f){var b=r.addPath(o,l),h=this;i.call(this,o,u),this.poll=new a(m,b,f),this.poll.on("message",function(g){h.emit("message",g)}),this.poll.once("close",function(g,S){h.poll=null,h.emit("close",g,S),h.close()})}t(s,i),s.prototype.close=function(){i.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},n.exports=s},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:void 0,inherits:54}],29:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter,i=e("eventsource"),a=function(){};function s(o){r.call(this);var l=this,u=this.es=new i(o);u.onmessage=function(m){a("message",m.data),l.emit("message",decodeURI(m.data))},u.onerror=function(m){a("error",u.readyState);var f=u.readyState!==2?"network":"permanent";l._cleanup(),l._close(f)}}t(s,r),s.prototype.abort=function(){this._cleanup(),this._close("user")},s.prototype._cleanup=function(){var o=this.es;o&&(o.onmessage=o.onerror=null,o.close(),this.es=null)},s.prototype._close=function(o){var l=this;setTimeout(function(){l.emit("close",null,o),l.removeAllListeners()},200)},n.exports=s},{debug:void 0,events:3,eventsource:18,inherits:54}],30:[function(e,n,p){(function(t){(function(){var r=e("inherits"),i=e("../../utils/iframe"),a=e("../../utils/url"),s=e("events").EventEmitter,o=e("../../utils/random"),l=function(){};function u(f){s.call(this);var b=this;i.polluteGlobalNamespace(),this.id="a"+o.string(6),f=a.addQuery(f,"c="+decodeURIComponent(i.WPrefix+"."+this.id)),l("using htmlfile",u.htmlfileEnabled);var h=u.htmlfileEnabled?i.createHtmlfile:i.createIframe;t[i.WPrefix][this.id]={start:function(){b.iframeObj.loaded()},message:function(g){b.emit("message",g)},stop:function(){b._cleanup(),b._close("network")}},this.iframeObj=h(f,function(){b._cleanup(),b._close("permanent")})}r(u,s),u.prototype.abort=function(){this._cleanup(),this._close("user")},u.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete t[i.WPrefix][this.id]},u.prototype._close=function(f){this.emit("close",null,f),this.removeAllListeners()},u.htmlfileEnabled=!1;var m=["Active"].concat("Object").join("X");if(m in t)try{u.htmlfileEnabled=!!new t[m]("htmlfile")}catch{}u.enabled=u.htmlfileEnabled||i.iframeEnabled,n.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],31:[function(e,n,p){(function(t){(function(){var r=e("../../utils/iframe"),i=e("../../utils/random"),a=e("../../utils/browser"),s=e("../../utils/url"),o=e("inherits"),l=e("events").EventEmitter,u=function(){};function m(f){var b=this;l.call(this),r.polluteGlobalNamespace(),this.id="a"+i.string(6);var h=s.addQuery(f,"c="+encodeURIComponent(r.WPrefix+"."+this.id));t[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(h),this.timeoutId=setTimeout(function(){b._abort(new Error("JSONP script loaded abnormally (timeout)"))},m.timeout)}o(m,l),m.prototype.abort=function(){if(t[r.WPrefix][this.id]){var f=new Error("JSONP user aborted read");f.code=1e3,this._abort(f)}},m.timeout=35e3,m.scriptErrorTimeout=1e3,m.prototype._callback=function(f){this._cleanup(),this.aborting||(f&&this.emit("message",f),this.emit("close",null,"network"),this.removeAllListeners())},m.prototype._abort=function(f){this._cleanup(),this.aborting=!0,this.emit("close",f.code,f.message),this.removeAllListeners()},m.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var f=this.script;f.parentNode.removeChild(f),f.onreadystatechange=f.onerror=f.onload=f.onclick=null,this.script=null}delete t[r.WPrefix][this.id]},m.prototype._scriptError=function(){var f=this;this.errorTimer||(this.errorTimer=setTimeout(function(){f.loadedOkay||f._abort(new Error("JSONP script loaded abnormally (onerror)"))},m.scriptErrorTimeout))},m.prototype._createScript=function(f){var b,h=this,g=this.script=t.document.createElement("script");if(g.id="a"+i.string(8),g.src=f,g.type="text/javascript",g.charset="UTF-8",g.onerror=this._scriptError.bind(this),g.onload=function(){h._abort(new Error("JSONP script loaded abnormally (onload)"))},g.onreadystatechange=function(){if(u("onreadystatechange",g.readyState),/loaded|closed/.test(g.readyState)){if(g&&g.htmlFor&&g.onclick){h.loadedOkay=!0;try{g.onclick()}catch{}}g&&h._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},g.async===void 0&&t.document.attachEvent)if(a.isOpera())(b=this.script2=t.document.createElement("script")).text="try{var a = document.getElementById('"+g.id+"'); if(a)a.onerror();}catch(x){};",g.async=b.async=!1;else{try{g.htmlFor=g.id,g.event="onclick"}catch{}g.async=!0}g.async!==void 0&&(g.async=!0);var S=t.document.getElementsByTagName("head")[0];S.insertBefore(g,S.firstChild),b&&S.insertBefore(b,S.firstChild)},n.exports=m}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],32:[function(e,n,p){var t=e("inherits"),r=e("events").EventEmitter;function i(a,s){r.call(this);var o=this;this.bufferPosition=0,this.xo=new s("POST",a,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(l,u){o._chunkHandler(l,u),o.xo=null;var m=l===200?"network":"permanent";o.emit("close",null,m),o._cleanup()})}t(i,r),i.prototype._chunkHandler=function(a,s){if(a===200&&s)for(var o=-1;;this.bufferPosition+=o+1){var l=s.slice(this.bufferPosition);if((o=l.indexOf(`
`))===-1)break;var u=l.slice(0,o);u&&this.emit("message",u)}},i.prototype._cleanup=function(){this.removeAllListeners()},i.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},n.exports=i},{debug:void 0,events:3,inherits:54}],33:[function(e,n,p){(function(t){(function(){var r,i,a=e("../../utils/random"),s=e("../../utils/url"),o=function(){};n.exports=function(l,u,m){r||((r=t.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(i=t.document.createElement("textarea")).name="d",r.appendChild(i),t.document.body.appendChild(r));var f="a"+a.string(8);r.target=f,r.action=s.addQuery(s.addPath(l,"/jsonp_send"),"i="+f);var b=function(g){try{return t.document.createElement('<iframe name="'+g+'">')}catch{var S=t.document.createElement("iframe");return S.name=g,S}}(f);b.id=f,b.style.display="none",r.appendChild(b);try{i.value=u}catch{}r.submit();function h(g){b.onerror&&(b.onreadystatechange=b.onerror=b.onload=null,setTimeout(function(){b.parentNode.removeChild(b),b=null},500),i.value="",m(g))}return b.onerror=function(){h()},b.onload=function(){h()},b.onreadystatechange=function(g){o("onreadystatechange",f,b.readyState),b.readyState==="complete"&&h()},function(){h(new Error("Aborted"))}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:void 0}],34:[function(e,n,p){(function(t){(function(){var r=e("events").EventEmitter,i=e("inherits"),a=e("../../utils/event"),s=e("../../utils/browser"),o=e("../../utils/url"),l=function(){};function u(m,f,b){var h=this;r.call(this),setTimeout(function(){h._start(m,f,b)},0)}i(u,r),u.prototype._start=function(m,f,b){var h=this,g=new t.XDomainRequest;f=o.addQuery(f,"t="+ +new Date),g.onerror=function(){h._error()},g.ontimeout=function(){h._error()},g.onprogress=function(){l("progress",g.responseText),h.emit("chunk",200,g.responseText)},g.onload=function(){h.emit("finish",200,g.responseText),h._cleanup(!1)},this.xdr=g,this.unloadRef=a.unloadAdd(function(){h._cleanup(!0)});try{this.xdr.open(m,f),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(b)}catch{this._error()}},u.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},u.prototype._cleanup=function(m){if(this.xdr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,m)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!(!t.XDomainRequest||!s.hasDomain()),n.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],35:[function(e,n,p){var t=e("inherits"),r=e("../driver/xhr");function i(a,s,o,l){r.call(this,a,s,o,l)}t(i,r),i.enabled=r.enabled&&r.supportsCORS,n.exports=i},{"../driver/xhr":17,inherits:54}],36:[function(e,n,p){var t=e("events").EventEmitter;function r(){var i=this;t.call(this),this.to=setTimeout(function(){i.emit("finish",200,"{}")},r.timeout)}e("inherits")(r,t),r.prototype.close=function(){clearTimeout(this.to)},r.timeout=2e3,n.exports=r},{events:3,inherits:54}],37:[function(e,n,p){var t=e("inherits"),r=e("../driver/xhr");function i(a,s,o){r.call(this,a,s,o,{noCredentials:!0})}t(i,r),i.enabled=r.enabled,n.exports=i},{"../driver/xhr":17,inherits:54}],38:[function(e,n,p){var t=e("../utils/event"),r=e("../utils/url"),i=e("inherits"),a=e("events").EventEmitter,s=e("./driver/websocket"),o=function(){};function l(u,m,f){if(!l.enabled())throw new Error("Transport created when disabled");a.call(this);var b=this,h=r.addPath(u,"/websocket");h=h.slice(0,5)==="https"?"wss"+h.slice(5):"ws"+h.slice(4),this.url=h,this.ws=new s(this.url,[],f),this.ws.onmessage=function(g){o("message event",g.data),b.emit("message",g.data)},this.unloadRef=t.unloadAdd(function(){b.ws.close()}),this.ws.onclose=function(g){o("close event",g.code,g.reason),b.emit("close",g.code,g.reason),b._cleanup()},this.ws.onerror=function(g){b.emit("close",1006,"WebSocket connection broken"),b._cleanup()}}i(l,a),l.prototype.send=function(u){var m="["+u+"]";this.ws.send(m)},l.prototype.close=function(){var u=this.ws;this._cleanup(),u&&u.close()},l.prototype._cleanup=function(){var u=this.ws;u&&(u.onmessage=u.onclose=u.onerror=null),t.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},l.enabled=function(){return!!s},l.transportName="websocket",l.roundTrips=2,n.exports=l},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:void 0,events:3,inherits:54}],39:[function(e,n,p){var t=e("inherits"),r=e("./lib/ajax-based"),i=e("./xdr-streaming"),a=e("./receiver/xhr"),s=e("./sender/xdr");function o(l){if(!s.enabled)throw new Error("Transport created when disabled");r.call(this,l,"/xhr",a,s)}t(o,r),o.enabled=i.enabled,o.transportName="xdr-polling",o.roundTrips=2,n.exports=o},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:54}],40:[function(e,n,p){var t=e("inherits"),r=e("./lib/ajax-based"),i=e("./receiver/xhr"),a=e("./sender/xdr");function s(o){if(!a.enabled)throw new Error("Transport created when disabled");r.call(this,o,"/xhr_streaming",i,a)}t(s,r),s.enabled=function(o){return!o.cookie_needed&&!o.nullOrigin&&a.enabled&&o.sameScheme},s.transportName="xdr-streaming",s.roundTrips=2,n.exports=s},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:54}],41:[function(e,n,p){var t=e("inherits"),r=e("./lib/ajax-based"),i=e("./receiver/xhr"),a=e("./sender/xhr-cors"),s=e("./sender/xhr-local");function o(l){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");r.call(this,l,"/xhr",i,a)}t(o,r),o.enabled=function(l){return!l.nullOrigin&&(!(!s.enabled||!l.sameOrigin)||a.enabled)},o.transportName="xhr-polling",o.roundTrips=2,n.exports=o},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],42:[function(e,n,p){(function(t){(function(){var r=e("inherits"),i=e("./lib/ajax-based"),a=e("./receiver/xhr"),s=e("./sender/xhr-cors"),o=e("./sender/xhr-local"),l=e("../utils/browser");function u(m){if(!o.enabled&&!s.enabled)throw new Error("Transport created when disabled");i.call(this,m,"/xhr_streaming",a,s)}r(u,i),u.enabled=function(m){return!m.nullOrigin&&!l.isOpera()&&s.enabled},u.transportName="xhr-streaming",u.roundTrips=2,u.needBody=!!t.document,n.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],43:[function(e,n,p){(function(t){(function(){t.crypto&&t.crypto.getRandomValues?n.exports.randomBytes=function(r){var i=new Uint8Array(r);return t.crypto.getRandomValues(i),i}:n.exports.randomBytes=function(r){for(var i=new Array(r),a=0;a<r;a++)i[a]=Math.floor(256*Math.random());return i}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],44:[function(e,n,p){(function(t){(function(){n.exports={isOpera:function(){return t.navigator&&/opera/i.test(t.navigator.userAgent)},isKonqueror:function(){return t.navigator&&/konqueror/i.test(t.navigator.userAgent)},hasDomain:function(){if(!t.document)return!0;try{return!!t.document.domain}catch{return!1}}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],45:[function(e,n,p){var t,r=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;n.exports={quote:function(i){var a=JSON.stringify(i);return r.lastIndex=0,r.test(a)?(t=t||function(s){var o,l={},u=[];for(o=0;o<65536;o++)u.push(String.fromCharCode(o));return s.lastIndex=0,u.join("").replace(s,function(m){return l[m]="\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4),""}),s.lastIndex=0,l}(r),a.replace(r,function(s){return t[s]})):a}}},{}],46:[function(e,n,p){(function(t){(function(){var r=e("./random"),i={},a=!1,s=t.chrome&&t.chrome.app&&t.chrome.app.runtime;n.exports={attachEvent:function(o,l){t.addEventListener!==void 0?t.addEventListener(o,l,!1):t.document&&t.attachEvent&&(t.document.attachEvent("on"+o,l),t.attachEvent("on"+o,l))},detachEvent:function(o,l){t.addEventListener!==void 0?t.removeEventListener(o,l,!1):t.document&&t.detachEvent&&(t.document.detachEvent("on"+o,l),t.detachEvent("on"+o,l))},unloadAdd:function(o){if(s)return null;var l=r.string(8);return i[l]=o,a&&setTimeout(this.triggerUnloadCallbacks,0),l},unloadDel:function(o){o in i&&delete i[o]},triggerUnloadCallbacks:function(){for(var o in i)i[o](),delete i[o]}},s||n.exports.attachEvent("unload",function(){a||(a=!0,n.exports.triggerUnloadCallbacks())})}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./random":50}],47:[function(e,n,p){(function(t){(function(){var r=e("./event"),i=e("./browser"),a=function(){};n.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){n.exports.WPrefix in t||(t[n.exports.WPrefix]={})},postMessage:function(s,o){t.parent!==t?t.parent.postMessage(JSON.stringify({windowId:n.exports.currentWindowId,type:s,data:o||""}),"*"):a()},createIframe:function(s,o){function l(){clearTimeout(f);try{h.onload=null}catch{}h.onerror=null}function u(){h&&(l(),setTimeout(function(){h&&h.parentNode.removeChild(h),h=null},0),r.unloadDel(b))}function m(g){h&&(u(),o(g))}var f,b,h=t.document.createElement("iframe");return h.src=s,h.style.display="none",h.style.position="absolute",h.onerror=function(){m("onerror")},h.onload=function(){clearTimeout(f),f=setTimeout(function(){m("onload timeout")},2e3)},t.document.body.appendChild(h),f=setTimeout(function(){m("timeout")},15e3),b=r.unloadAdd(u),{post:function(g,S){setTimeout(function(){try{h&&h.contentWindow&&h.contentWindow.postMessage(g,S)}catch{}},0)},cleanup:u,loaded:l}},createHtmlfile:function(s,o){function l(){clearTimeout(f),h.onerror=null}function u(){S&&(l(),r.unloadDel(b),h.parentNode.removeChild(h),h=S=null,CollectGarbage())}function m(j){S&&(u(),o(j))}var f,b,h,g=["Active"].concat("Object").join("X"),S=new t[g]("htmlfile");S.open(),S.write('<html><script>document.domain="'+t.document.domain+'";<\/script></html>'),S.close(),S.parentWindow[n.exports.WPrefix]=t[n.exports.WPrefix];var O=S.createElement("div");return S.body.appendChild(O),h=S.createElement("iframe"),O.appendChild(h),h.src=s,h.onerror=function(){m("onerror")},f=setTimeout(function(){m("timeout")},15e3),b=r.unloadAdd(u),{post:function(j,x){try{setTimeout(function(){h&&h.contentWindow&&h.contentWindow.postMessage(j,x)},0)}catch{}},cleanup:u,loaded:l}}},n.exports.iframeEnabled=!1,t.document&&(n.exports.iframeEnabled=(typeof t.postMessage=="function"||typeof t.postMessage=="object")&&!i.isKonqueror())}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./browser":44,"./event":46,debug:void 0}],48:[function(e,n,p){(function(t){(function(){var r={};["log","debug","warn"].forEach(function(i){var a;try{a=t.console&&t.console[i]&&t.console[i].apply}catch{}r[i]=a?function(){return t.console[i].apply(t.console,arguments)}:i==="log"?function(){}:r.log}),n.exports=r}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(e,n,p){n.exports={isObject:function(t){var r=typeof t;return r=="function"||r=="object"&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var r,i,a=1,s=arguments.length;a<s;a++)for(i in r=arguments[a])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}}},{}],50:[function(e,n,p){var t=e("crypto"),r="abcdefghijklmnopqrstuvwxyz012345";n.exports={string:function(i){for(var a=r.length,s=t.randomBytes(i),o=[],l=0;l<i;l++)o.push(r.substr(s[l]%a,1));return o.join("")},number:function(i){return Math.floor(Math.random()*i)},numberString:function(i){var a=(""+(i-1)).length;return(new Array(a+1).join("0")+this.number(i)).slice(-a)}}},{crypto:43}],51:[function(e,n,p){var t=function(){};n.exports=function(r){return{filterToEnabled:function(i,a){var s={main:[],facade:[]};return i?typeof i=="string"&&(i=[i]):i=[],r.forEach(function(o){o&&(o.transportName!=="websocket"||a.websocket!==!1?i.length&&i.indexOf(o.transportName)===-1?t("not in whitelist",o.transportName):o.enabled(a)?(t("enabled",o.transportName),s.main.push(o),o.facadeTransport&&s.facade.push(o.facadeTransport)):t("disabled",o.transportName):t())}),s}}}},{debug:void 0}],52:[function(e,n,p){var t=e("url-parse");n.exports={getOrigin:function(r){if(!r)return null;var i=new t(r);if(i.protocol==="file:")return null;var a=i.port;return a=a||(i.protocol==="https:"?"443":"80"),i.protocol+"//"+i.hostname+":"+a},isOriginEqual:function(r,i){var a=this.getOrigin(r)===this.getOrigin(i);return a},isSchemeEqual:function(r,i){return r.split(":")[0]===i.split(":")[0]},addPath:function(r,i){var a=r.split("?");return a[0]+i+(a[1]?"?"+a[1]:"")},addQuery:function(r,i){return r+(r.indexOf("?")===-1?"?"+i:"&"+i)},isLoopbackAddr:function(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^\[::1\]$/.test(r)}}},{debug:void 0,"url-parse":57}],53:[function(e,n,p){n.exports="1.6.1"},{}],54:[function(e,n,p){typeof Object.create=="function"?n.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(t,r){if(r){let i=function(){};t.super_=r,i.prototype=r.prototype,t.prototype=new i,t.prototype.constructor=t}}},{}],55:[function(e,n,p){var t=Object.prototype.hasOwnProperty;function r(i){try{return decodeURIComponent(i.replace(/\+/g," "))}catch{return null}}p.stringify=function(i,a){a=a||"";var s,o,l=[];for(o in typeof a!="string"&&(a="?"),i)if(t.call(i,o)){if((s=i[o])||s!=null&&!isNaN(s)||(s=""),o=encodeURIComponent(o),s=encodeURIComponent(s),o===null||s===null)continue;l.push(o+"="+s)}return l.length?a+l.join("&"):""},p.parse=function(i){for(var a,s=/([^=?&]+)=?([^&]*)/g,o={};a=s.exec(i);){var l=r(a[1]),u=r(a[2]);l===null||u===null||l in o||(o[l]=u)}return o}},{}],56:[function(e,n,p){n.exports=function(t,r){if(r=r.split(":")[0],!(t=+t))return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}},{}],57:[function(e,n,p){(function(t){(function(){var r=e("requires-port"),i=e("querystringify"),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,m=/^[a-zA-Z]:/;function f(x){return(x||"").toString().replace(a,"")}var b=[["#","hash"],["?","query"],function(x,_){return S(_.protocol)?x.replace(/\\/g,"/"):x},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};function g(x){var _,k=(typeof window<"u"?window:t!==void 0?t:typeof self<"u"?self:{}).location||{},d={},A=typeof(x=x||k);if(x.protocol==="blob:")d=new j(unescape(x.pathname),{});else if(A=="string")for(_ in d=new j(x,{}),h)delete d[_];else if(A=="object"){for(_ in x)_ in h||(d[_]=x[_]);d.slashes===void 0&&(d.slashes=o.test(x.href))}return d}function S(x){return x==="file:"||x==="ftp:"||x==="http:"||x==="https:"||x==="ws:"||x==="wss:"}function O(x,_){x=(x=f(x)).replace(s,""),_=_||{};var k,d=u.exec(x),A=d[1]?d[1].toLowerCase():"",E=!!d[2],N=!!d[3],y=0;return E?y=N?(k=d[2]+d[3]+d[4],d[2].length+d[3].length):(k=d[2]+d[4],d[2].length):N?(k=d[3]+d[4],y=d[3].length):k=d[4],A==="file:"?2<=y&&(k=k.slice(2)):S(A)?k=d[4]:A?E&&(k=k.slice(2)):2<=y&&S(_.protocol)&&(k=d[4]),{protocol:A,slashes:E||S(A),slashesCount:y,rest:k}}function j(x,_,k){if(x=(x=f(x)).replace(s,""),!(this instanceof j))return new j(x,_,k);var d,A,E,N,y,C,T=b.slice(),L=typeof _,w=this,H=0;for(L!="object"&&L!="string"&&(k=_,_=null),k&&typeof k!="function"&&(k=i.parse),d=!(A=O(x||"",_=g(_))).protocol&&!A.slashes,w.slashes=A.slashes||d&&_.slashes,w.protocol=A.protocol||_.protocol||"",x=A.rest,(A.protocol==="file:"&&(A.slashesCount!==2||m.test(x))||!A.slashes&&(A.protocol||A.slashesCount<2||!S(w.protocol)))&&(T[3]=[/(.*)/,"pathname"]);H<T.length;H++)typeof(N=T[H])!="function"?(E=N[0],C=N[1],E!=E?w[C]=x:typeof E=="string"?~(y=E==="@"?x.lastIndexOf(E):x.indexOf(E))&&(x=typeof N[2]=="number"?(w[C]=x.slice(0,y),x.slice(y+N[2])):(w[C]=x.slice(y),x.slice(0,y))):(y=E.exec(x))&&(w[C]=y[1],x=x.slice(0,y.index)),w[C]=w[C]||d&&N[3]&&_[C]||"",N[4]&&(w[C]=w[C].toLowerCase())):x=N(x,w);k&&(w.query=k(w.query)),d&&_.slashes&&w.pathname.charAt(0)!=="/"&&(w.pathname!==""||_.pathname!=="")&&(w.pathname=function(R,W){if(R==="")return W;for(var M=(W||"/").split("/").slice(0,-1).concat(R.split("/")),B=M.length,D=M[B-1],te=!1,Z=0;B--;)M[B]==="."?M.splice(B,1):M[B]===".."?(M.splice(B,1),Z++):Z&&(B===0&&(te=!0),M.splice(B,1),Z--);return te&&M.unshift(""),D!=="."&&D!==".."||M.push(""),M.join("/")}(w.pathname,_.pathname)),w.pathname.charAt(0)!=="/"&&S(w.protocol)&&(w.pathname="/"+w.pathname),r(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(~(y=w.auth.indexOf(":"))?(w.username=w.auth.slice(0,y),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=w.auth.slice(y+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(w.auth)),w.auth=w.password?w.username+":"+w.password:w.username),w.origin=w.protocol!=="file:"&&S(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}j.prototype={set:function(x,_,k){var d=this;switch(x){case"query":typeof _=="string"&&_.length&&(_=(k||i.parse)(_)),d[x]=_;break;case"port":d[x]=_,r(_,d.protocol)?_&&(d.host=d.hostname+":"+_):(d.host=d.hostname,d[x]="");break;case"hostname":d[x]=_,d.port&&(_+=":"+d.port),d.host=_;break;case"host":d[x]=_,l.test(_)?(_=_.split(":"),d.port=_.pop(),d.hostname=_.join(":")):(d.hostname=_,d.port="");break;case"protocol":d.protocol=_.toLowerCase(),d.slashes=!k;break;case"pathname":case"hash":if(_){var A=x==="pathname"?"/":"#";d[x]=_.charAt(0)!==A?A+_:_}else d[x]=_;break;case"username":case"password":d[x]=encodeURIComponent(_);break;case"auth":var E=_.indexOf(":");~E?(d.username=_.slice(0,E),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=_.slice(E+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(_))}for(var N=0;N<b.length;N++){var y=b[N];y[4]&&(d[y[1]]=d[y[1]].toLowerCase())}return d.auth=d.password?d.username+":"+d.password:d.username,d.origin=d.protocol!=="file:"&&S(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString(),d},toString:function(x){x&&typeof x=="function"||(x=i.stringify);var _,k=this,d=k.host,A=k.protocol;A&&A.charAt(A.length-1)!==":"&&(A+=":");var E=A+(k.protocol&&k.slashes||S(k.protocol)?"//":"");return k.username?(E+=k.username,k.password&&(E+=":"+k.password),E+="@"):k.password?(E+=":"+k.password,E+="@"):k.protocol!=="file:"&&S(k.protocol)&&!d&&k.pathname!=="/"&&(E+="@"),(d[d.length-1]===":"||l.test(k.hostname)&&!k.port)&&(d+=":"),E+=d+k.pathname,(_=typeof k.query=="object"?x(k.query):k.query)&&(E+=_.charAt(0)!=="?"?"?"+_:_),k.hash&&(E+=k.hash),E}},j.extractProtocol=O,j.location=g,j.trimLeft=f,j.qs=i,n.exports=j}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{querystringify:55,"requires-port":56}]},{},[1])(1)})})(re);var ce=re.exports;const ue=ae(ce),J={LF:`
`,NULL:"\0"};class G{constructor(c){const{command:e,headers:n,body:p,binaryBody:t,escapeHeaderValues:r,skipContentLengthHeader:i}=c;this.command=e,this.headers=Object.assign({},n||{}),t?(this._binaryBody=t,this.isBinaryBody=!0):(this._body=p||"",this.isBinaryBody=!1),this.escapeHeaderValues=r||!1,this.skipContentLengthHeader=i||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(c,e){const n={},p=t=>t.replace(/^\s+|\s+$/g,"");for(const t of c.headers.reverse()){t.indexOf(":");const r=p(t[0]);let i=p(t[1]);e&&c.command!=="CONNECT"&&c.command!=="CONNECTED"&&(i=G.hdrValueUnEscape(i)),n[r]=i}return new G({command:c.command,headers:n,binaryBody:c.binaryBody,escapeHeaderValues:e})}toString(){return this.serializeCmdAndHeaders()}serialize(){const c=this.serializeCmdAndHeaders();return this.isBinaryBody?G.toUnit8Array(c,this._binaryBody).buffer:c+this._body+J.NULL}serializeCmdAndHeaders(){const c=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(const e of Object.keys(this.headers||{})){const n=this.headers[e];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?c.push(`${e}:${G.hdrValueEscape(`${n}`)}`):c.push(`${e}:${n}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&c.push(`content-length:${this.bodyLength()}`),c.join(J.LF)+J.LF+J.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){const c=this.binaryBody;return c?c.length:0}static sizeOfUTF8(c){return c?new TextEncoder().encode(c).length:0}static toUnit8Array(c,e){const n=new TextEncoder().encode(c),p=new Uint8Array([0]),t=new Uint8Array(n.length+e.length+p.length);return t.set(n),t.set(e,n.length),t.set(p,n.length+e.length),t}static marshall(c){return new G(c).serialize()}static hdrValueEscape(c){return c.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(c){return c.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}}const ne=0,X=10,Q=13,le=58;class he{constructor(c,e){this.onFrame=c,this.onIncomingPing=e,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(c,e=!1){let n;if(typeof c=="string"?n=this._encoder.encode(c):n=new Uint8Array(c),e&&n[n.length-1]!==0){const p=new Uint8Array(n.length+1);p.set(n,0),p[n.length]=0,n=p}for(let p=0;p<n.length;p++){const t=n[p];this._onByte(t)}}_collectFrame(c){if(c!==ne&&c!==Q){if(c===X){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(c)}}_collectCommand(c){if(c!==Q){if(c===X){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(c)}}_collectHeaders(c){if(c!==Q){if(c===X){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(c)}}_reinjectByte(c){this._onByte(c)}_collectHeaderKey(c){if(c===le){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(c)}_collectHeaderValue(c){if(c!==Q){if(c===X){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(c)}}_setupCollectBody(){const c=this._results.headers.filter(e=>e[0]==="content-length")[0];c?(this._bodyBytesRemaining=parseInt(c[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(c){if(c===ne){this._retrievedBody();return}this._consumeByte(c)}_collectBodyFixedSize(c){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(c)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(c){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",c)}this._initState()}_consumeByte(c){this._token.push(c)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){const c=new Uint8Array(this._token);return this._token=[],c}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}}var V;(function(v){v[v.CONNECTING=0]="CONNECTING",v[v.OPEN=1]="OPEN",v[v.CLOSING=2]="CLOSING",v[v.CLOSED=3]="CLOSED"})(V=V||(V={}));var P;(function(v){v[v.ACTIVE=0]="ACTIVE",v[v.DEACTIVATING=1]="DEACTIVATING",v[v.INACTIVE=2]="INACTIVE"})(P=P||(P={}));class U{constructor(c){this.versions=c}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(c=>`v${c.replace(".","")}.stomp`)}}U.V1_0="1.0";U.V1_1="1.1";U.V1_2="1.2";U.default=new U([U.V1_2,U.V1_1,U.V1_0]);function de(v,c){v.terminate=function(){const e=()=>{};this.onerror=e,this.onmessage=e,this.onopen=e;const n=new Date,p=Math.random().toString().substring(2,8),t=this.onclose;this.onclose=r=>{const i=new Date().getTime()-n.getTime();c(`Discarded socket (#${p})  closed after ${i}ms, with code/reason: ${r.code}/${r.reason}`)},this.close(),t==null||t.call(v,{code:4001,reason:`Quick discarding socket (#${p}) without waiting for the shutdown sequence.`,wasClean:!1})}}class fe{constructor(c,e,n){this._client=c,this._webSocket=e,this._connected=!1,this._serverFrameHandlers={CONNECTED:p=>{this.debug(`connected to server ${p.headers.server}`),this._connected=!0,this._connectedVersion=p.headers.version,this._connectedVersion===U.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(p.headers),this.onConnect(p)},MESSAGE:p=>{const t=p.headers.subscription,r=this._subscriptions[t]||this.onUnhandledMessage,i=p,a=this,s=this._connectedVersion===U.V1_2?i.headers.ack:i.headers["message-id"];i.ack=(o={})=>a.ack(s,t,o),i.nack=(o={})=>a.nack(s,t,o),r(i)},RECEIPT:p=>{const t=this._receiptWatchers[p.headers["receipt-id"]];t?(t(p),delete this._receiptWatchers[p.headers["receipt-id"]]):this.onUnhandledReceipt(p)},ERROR:p=>{this.onStompError(p)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){const c=new he(e=>{const n=G.fromRawFrame(e,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${n}`),(this._serverFrameHandlers[n.command]||this.onUnhandledFrame)(n)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=e=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){const n=e.data instanceof ArrayBuffer?new TextDecoder().decode(e.data):e.data;this.debug(`<<< ${n}`)}c.parseChunk(e.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=e=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(e)},this._webSocket.onerror=e=>{this.onWebSocketError(e)},this._webSocket.onopen=()=>{const e=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),e["accept-version"]=this.stompVersions.supportedVersions(),e["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:e})}}_setupHeartbeat(c){if(c.version!==U.V1_1&&c.version!==U.V1_2||!c["heart-beat"])return;const[e,n]=c["heart-beat"].split(",").map(p=>parseInt(p,10));if(this.heartbeatOutgoing!==0&&n!==0){const p=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${p}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===V.OPEN&&(this._webSocket.send(J.LF),this.debug(">>> PING"))},p)}if(this.heartbeatIncoming!==0&&e!==0){const p=Math.max(this.heartbeatIncoming,e);this.debug(`check PONG every ${p}ms`),this._ponger=setInterval(()=>{const t=Date.now()-this._lastServerActivityTS;t>p*2&&(this.debug(`did not receive server activity for the last ${t}ms`),this._closeOrDiscardWebsocket())},p)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===V.CONNECTING||this._webSocket.readyState===V.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&de(this._webSocket,c=>this.debug(c)),this._webSocket.terminate()}_transmit(c){const{command:e,headers:n,body:p,binaryBody:t,skipContentLengthHeader:r}=c,i=new G({command:e,headers:n,body:p,binaryBody:t,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:r});let a=i.serialize();if(this.logRawCommunication?this.debug(`>>> ${a}`):this.debug(`>>> ${i}`),this.forceBinaryWSFrames&&typeof a=="string"&&(a=new TextEncoder().encode(a)),typeof a!="string"||!this.splitLargeFrames)this._webSocket.send(a);else{let s=a;for(;s.length>0;){const o=s.substring(0,this.maxWebSocketChunkSize);s=s.substring(this.maxWebSocketChunkSize),this._webSocket.send(o),this.debug(`chunk sent = ${o.length}, remaining = ${s.length}`)}}}dispose(){if(this.connected)try{const c=Object.assign({},this.disconnectHeaders);c.receipt||(c.receipt=`close-${this._counter++}`),this.watchForReceipt(c.receipt,e=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(e)}),this._transmit({command:"DISCONNECT",headers:c})}catch(c){this.debug(`Ignoring error during disconnect ${c}`)}else(this._webSocket.readyState===V.CONNECTING||this._webSocket.readyState===V.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(c){const{destination:e,headers:n,body:p,binaryBody:t,skipContentLengthHeader:r}=c,i=Object.assign({destination:e},n);this._transmit({command:"SEND",headers:i,body:p,binaryBody:t,skipContentLengthHeader:r})}watchForReceipt(c,e){this._receiptWatchers[c]=e}subscribe(c,e,n={}){n=Object.assign({},n),n.id||(n.id=`sub-${this._counter++}`),n.destination=c,this._subscriptions[n.id]=e,this._transmit({command:"SUBSCRIBE",headers:n});const p=this;return{id:n.id,unsubscribe(t){return p.unsubscribe(n.id,t)}}}unsubscribe(c,e={}){e=Object.assign({},e),delete this._subscriptions[c],e.id=c,this._transmit({command:"UNSUBSCRIBE",headers:e})}begin(c){const e=c||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:e}});const n=this;return{id:e,commit(){n.commit(e)},abort(){n.abort(e)}}}commit(c){this._transmit({command:"COMMIT",headers:{transaction:c}})}abort(c){this._transmit({command:"ABORT",headers:{transaction:c}})}ack(c,e,n={}){n=Object.assign({},n),this._connectedVersion===U.V1_2?n.id=c:n["message-id"]=c,n.subscription=e,this._transmit({command:"ACK",headers:n})}nack(c,e,n={}){return n=Object.assign({},n),this._connectedVersion===U.V1_2?n.id=c:n["message-id"]=c,n.subscription=e,this._transmit({command:"NACK",headers:n})}}class pe{constructor(c={}){this.stompVersions=U.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=P.INACTIVE;const e=()=>{};this.debug=e,this.beforeConnect=e,this.onConnect=e,this.onDisconnect=e,this.onUnhandledMessage=e,this.onUnhandledReceipt=e,this.onUnhandledFrame=e,this.onStompError=e,this.onWebSocketClose=e,this.onWebSocketError=e,this.logRawCommunication=!1,this.onChangeState=e,this.connectHeaders={},this._disconnectHeaders={},this.configure(c)}get webSocket(){var c;return(c=this._stompHandler)==null?void 0:c._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(c){this._disconnectHeaders=c,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===P.ACTIVE}_changeState(c){this.state=c,this.onChangeState(c)}configure(c){Object.assign(this,c)}activate(){const c=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(P.ACTIVE),this._connect()};this.state===P.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{c()})):c()}async _connect(){if(await this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");const c=this._createWebSocket();this._stompHandler=new fe(this,c,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:e=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(e)},onDisconnect:e=>{this.onDisconnect(e)},onStompError:e=>{this.onStompError(e)},onWebSocketClose:e=>{this._stompHandler=void 0,this.state===P.DEACTIVATING&&this._changeState(P.INACTIVE),this.onWebSocketClose(e),this.active&&this._schedule_reconnect()},onWebSocketError:e=>{this.onWebSocketError(e)},onUnhandledMessage:e=>{this.onUnhandledMessage(e)},onUnhandledReceipt:e=>{this.onUnhandledReceipt(e)},onUnhandledFrame:e=>{this.onUnhandledFrame(e)}}),this._stompHandler.start()}_createWebSocket(){let c;if(this.webSocketFactory)c=this.webSocketFactory();else if(this.brokerURL)c=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return c.binaryType="arraybuffer",c}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}async deactivate(c={}){var t;const e=c.force||!1,n=this.active;let p;if(this.state===P.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(P.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==V.CLOSED){const r=this._stompHandler.onWebSocketClose;p=new Promise((i,a)=>{this._stompHandler.onWebSocketClose=s=>{r(s),i()}})}else return this._changeState(P.INACTIVE),Promise.resolve();return e?(t=this._stompHandler)==null||t.discardWebsocket():n&&this._disposeStompHandler(),p}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(c){this._checkConnection(),this._stompHandler.publish(c)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(c,e){this._checkConnection(),this._stompHandler.watchForReceipt(c,e)}subscribe(c,e,n={}){return this._checkConnection(),this._stompHandler.subscribe(c,e,n)}unsubscribe(c,e={}){this._checkConnection(),this._stompHandler.unsubscribe(c,e)}begin(c){return this._checkConnection(),this._stompHandler.begin(c)}commit(c){this._checkConnection(),this._stompHandler.commit(c)}abort(c){this._checkConnection(),this._stompHandler.abort(c)}ack(c,e,n={}){this._checkConnection(),this._stompHandler.ack(c,e,n)}nack(c,e,n={}){this._checkConnection(),this._stompHandler.nack(c,e,n)}}var me=Object.defineProperty,be=(v,c)=>{for(var e in c)me(v,e,{get:c[e],enumerable:!0})},Y=new Map,ve=v=>{if(Y.has(v))return Y.get(v);let c=F.createContext(void 0);return Y.set(v,c),c},ee=ve;function ge(v){let{url:c,children:e,enabled:n,name:p,...t}=v,r=ee(p||"default"),[i,a]=F.useState(void 0),s=F.useRef(new Map);F.useEffect(()=>{let l=new pe(t);return!t.brokerURL&&!t.webSocketFactory&&(l.webSocketFactory=function(){var m;let u=new URL(c,(m=window==null?void 0:window.location)==null?void 0:m.href);if(u.protocol==="http:"||u.protocol==="https:")return new ue(c);if(u.protocol==="ws:"||u.protocol==="wss:")return new WebSocket(c);throw new Error("Protocol not supported")}),l.onConnect=function(u){t.onConnect&&t.onConnect(u),s.current.forEach(m=>{m.subscription=l.subscribe(m.destination,m.callback,m.headers)}),a(l)},l.onWebSocketClose=function(u){t.onWebSocketClose&&t.onWebSocketClose(u),a(void 0)},t.onStompError||(l.onStompError=function(u){throw u}),n!==!1&&l.activate(),()=>{l.deactivate()}},[c,n,...Object.values(t)]);let o=(l,u,m={})=>{let f=Math.random().toString(36).substr(2,9),b={destination:l,callback:u,headers:m};return s.current.set(f,b),i&&i.connected&&(b.subscription=i.subscribe(l,u,m)),()=>{let h=s.current.get(f);h.subscription&&h.subscription.unsubscribe(),s.current.delete(f)}};return ie.jsx(r.Provider,{value:{client:i,subscribe:o},children:e})}var Ie=ge;function ye(v){let c=F.useContext(ee(v||"default"));if(c===void 0)throw new Error("There must be a StompSessionProvider as Ancestor of all Stomp Hooks and HOCs");return c.client}var we=ye,_e={};be(_e,{StompSessionProviderMock:()=>Ce,getMockClient:()=>se,getMockSubscriptions:()=>Se,getSentMockMessages:()=>ke,mockClientPublish:()=>oe,mockReceiveMessage:()=>Ee,reset:()=>Te});var q=new Map;function xe(v,c,e={}){let n=Math.random().toString(36).substr(2,9);return q.has(v)||q.set(v,new Map),q.get(v).set(n,c),()=>{q.get(v).delete(n)}}function Ee(v,c){q.has(v)&&q.get(v).forEach(e=>{e(c)})}function Se(v){return v?q.get(v):q}var $=new Map;function oe(v){$.has(v.destination)||$.set(v.destination,[]),$.get(v.destination).push(v)}function se(){return{publish:oe}}function ke(v){return v?$.get(v):$}function Ce(v){let c=ee(v.name||"default");return ie.jsx(c.Provider,{value:{subscribe:xe,client:v.client??se()},children:v.children})}function Te(){q.clear(),$.clear()}const je=()=>{const v=we(),c=F.useRef(null),e=F.useRef(!1),n=F.useRef(null),p=(u,m)=>{if(v!=null&&v.connected&&!c.current){const f=v.subscribe(u,b=>{const h=JSON.parse(b.body);m(h)});return c.current=f,f}},t=()=>{const u=c.current;v!=null&&v.connected&&u&&(u.unsubscribe(),c.current=null)},r=(u,m)=>{v!=null&&v.connected&&!e.current&&(v.subscribe(u,f=>{const b=JSON.parse(f.body);m(h=>{const g=[...h.events||[],b];return{...h,events:g}})}),e.current=!0)},i=(u,m)=>{if(v!=null&&v.connected&&!n.current){const f=v.subscribe(u,b=>{const h=JSON.parse(b.body);m(g=>{const S=new Map(g);return S.set(h.userId.toString(),h.isOnline),S})});return n.current=f,f}},a=()=>{const u=n.current;v!=null&&v.connected&&u&&(u.unsubscribe(),n.current=null)},s=u=>{v!=null&&v.connected?v.publish({destination:"/chat/messages",body:JSON.stringify(u)}):console.error("MESSAGE.Stomp client is not connected or no current room.")},o=(u,m)=>{v!=null&&v.connected?v.publish({destination:m,body:JSON.stringify(u)}):console.error("EVENT.Stomp client is not connected or no current room.")},l=()=>{v!=null&&v.connected&&(v.deactivate(),console.log("Stomp client deactivated on logout"))};return F.useEffect(()=>(v&&!v.connected&&(v.activate(),console.log("Stomp client activated")),()=>{v!=null&&v.connected&&v.deactivate()}),[v]),{stompClient:v,subscribeToMessages:p,unsubscribeFromMessages:t,subscribeToUserErrors:r,subscribeToUsersStatuses:i,unsubscribeFromUsersStatuses:a,sendMessage:s,sendEvent:o,handleDeactivateStopmClient:l}};function Ae(v){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M12 16v-4"},child:[]},{tag:"path",attr:{d:"M12 8h.01"},child:[]}]})(v)}function Le(v){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",x2:"9",y1:"12",y2:"12"},child:[]}]})(v)}function Re(v){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v5Z"},child:[]},{tag:"path",attr:{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1"},child:[]}]})(v)}function He(v){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"},child:[]},{tag:"path",attr:{d:"m15 5 4 4"},child:[]}]})(v)}function We(v){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 6 6 18"},child:[]},{tag:"path",attr:{d:"m6 6 12 12"},child:[]}]})(v)}export{Ie as J,Le as L,Ae as a,Re as b,He as c,We as d,je as u};
